<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <style>
    li {
    }
    ul{
    }
    button{
    }
    </style>
    <title>Document</title>
</head>
<body>
    <div>
        <label>Number A:<input id="radio-a" type="radio" name="math-obj" value="a"></label><input id="num-a" type="text">
        <label>Number B:<input id="radio-b" type="radio" name="math-obj" value="b"></label><input id="num-b" type="text">
    </div>
    <div>
        <ul>
            <li><button>判断当前选中的输入框输入内容是否为数字</button></li>
            <li><button>把 A 四舍五入为 B 个小数位数的数字</button></li>
            <li><button>当前选中数字的绝对值</button></li>
            <li><button>对当前选中的数字进行上舍入</button></li>
            <li><button>对当前选中的数字进行下舍入</button></li>
            <li><button>把当前选中的数字四舍五入为最接近的整数</button></li>
            <li><button>返回 A 和 B 中的最高值</button></li>
            <li><button>返回 A 和 B 中的最低值</button></li>
        </ul>        
    </div>
    <p id="result"></p>
    <script>
    var firstRadioItem = document.querySelector("#radio-a");
    var secondRadioItem = document.querySelector("#radio-b");
    var radioList = [firstRadioItem,secondRadioItem];
    var hasChecked = false;//是否有radio被选中标识
    var firstInputItem = document.querySelector("#num-a");
    var secondInputItem = document.querySelector("#num-b");
    var buttonList = document.querySelectorAll("button");
    var resultP = document.querySelector("#result");

    buttonList[0].addEventListener("click",firstButton);
    buttonList[1].addEventListener("click",secondButton);
    buttonList[2].addEventListener("click",thirdButton);
    buttonList[3].addEventListener("click",forthButton);
    buttonList[4].addEventListener("click",fifthButton);
    buttonList[5].addEventListener("click",sixthButton);
    buttonList[6].addEventListener("click",seventhButton);
    buttonList[7].addEventListener("click",eighthButton);
    //修改改善点：运用事件委托


    function firstButton() {
        for (let index = 0; index < radioList.length; index++) {
            if (radioList[index].checked == true) {
                hasChecked = true;
                var checkedInput = radioList[index].parentNode.nextSibling.value;
                if (checkedInput.length > 0) {
                    var checkedInput = +checkedInput;//输入框value值默认为string类型
                    if (isNum(checkedInput))  {
                        resultP.innerHTML="当前选中的输入框输入内容是数字";
                    }else{
                        resultP.innerHTML="当前选中的输入框输入内容不是数字";
                    }
                }else{
                    alert("选中目标未赋值!");
                }
            }
        }
        if (!hasChecked) {
            alert("我还没有目标!");
        }
    }

    function secondButton() {
        if (firstInputItem.value.length > 0) {
            var firstNum = +firstInputItem.value;
            var secondNum = +secondInputItem.value;
            if (isNum(firstNum) && isNum(secondNum)) {
                var calcresult = set4out5in(firstNum,secondNum);
                resultP.innerHTML = "四舍五入结果为:"+calcresult;
            }
            else{
                console.log("已输入非数字文本，请修改");
            }
        }
        else{
            alert("你还没有输入任何值");
        }
    }
    
    function thirdButton() {
        for (let index = 0; index < radioList.length; index++) {
            if (radioList[index].checked == true) {
                hasChecked = true;
                var checkedInput = radioList[index].parentNode.nextSibling.value;
                if (checkedInput.length > 0) {
                    var checkedInput = +checkedInput;//输入框value值默认为string类型
                    if (isNum(checkedInput))  {
                        resultP.innerHTML="当前当前选中的输入框输入内容的绝对值是："+Math.abs(checkedInput);
                    }else{
                        resultP.innerHTML="当前选中的输入框输入内容不是数字";
                    }
                }else{
                    alert("选中目标未赋值!");
                }
            }
        }
        if (!hasChecked) {
            alert("我还没有目标!");
        }
    }

    function forthButton(){
        for (let index = 0; index < radioList.length; index++) {
            if (radioList[index].checked == true) {
                hasChecked = true;
                var checkedInput = radioList[index].parentNode.nextSibling.value;
                if (checkedInput.length > 0) {
                    var checkedInput = +checkedInput;//输入框value值默认为string类型
                    if (isNum(checkedInput))  {
                        resultP.innerHTML="当前当前选中的输入框输入内容的上取整是："+Math.ceil(checkedInput);
                    }else{
                        resultP.innerHTML="当前选中的输入框输入内容不是数字";
                    }
                }else{
                    alert("选中目标未赋值!");
                }
            }
        }
        if (!hasChecked) {
            alert("我还没有目标!");
        }
    }

    function fifthButton(){
        for (let index = 0; index < radioList.length; index++) {
            if (radioList[index].checked == true) {
                hasChecked = true;
                var checkedInput = radioList[index].parentNode.nextSibling.value;
                if (checkedInput.length > 0) {
                    var checkedInput = +checkedInput;//输入框value值默认为string类型
                    if (isNum(checkedInput))  {
                        resultP.innerHTML="当前当前选中的输入框输入内容的下取整是："+Math.floor(checkedInput);
                    }else{
                        resultP.innerHTML="当前选中的输入框输入内容不是数字";
                    }
                }else{
                    alert("选中目标未赋值!");
                }
            }
        }
        if (!hasChecked) {
            alert("我还没有目标!");
        }
    }

    function sixthButton() {
        for (let index = 0; index < radioList.length; index++) {
            if (radioList[index].checked == true) {
                hasChecked = true;
                var checkedInput = radioList[index].parentNode.nextSibling.value;
                if (checkedInput.length > 0) {
                    var checkedInput = +checkedInput;//输入框value值默认为string类型
                    if (isNum(checkedInput))  {
                        resultP.innerHTML="当前当前选中的输入框输入内容的四舍五入最接近的整数是："+set4out5in(checkedInput,0);
                    }else{
                        resultP.innerHTML="当前选中的输入框输入内容不是数字";
                    }
                }else{
                    alert("选中目标未赋值!");
                }
            }
        }
        if (!hasChecked) {
            alert("我还没有目标!");
        }
    }

    function seventhButton() {
        if (firstInputItem.value.length > 0) {
            var firstNum = +firstInputItem.value;
            var secondNum = +secondInputItem.value;
            if (isNum(firstNum) && isNum(secondNum)) {
                var calcresult = firstNum >= secondNum ? firstNum: secondNum;
                resultP.innerHTML = "最高值为:"+calcresult;
            }
            else{
                console.log("已输入非数字文本，请修改");
            }
        }
        else{
            alert("你还没有输入任何值");
        }
    }

    function eighthButton() {
        if (firstInputItem.value.length > 0) {
            var firstNum = +firstInputItem.value;
            var secondNum = +secondInputItem.value;
            if (isNum(firstNum) && isNum(secondNum)) {
                var calcresult = firstNum <= secondNum ? firstNum: secondNum;
                resultP.innerHTML = "最低值为:"+calcresult;
            }
            else{
                console.log("已输入非数字文本，请修改");
            }
        }
        else{
            alert("你还没有输入任何值");
        }
    }


    function isNum(params) {
        if (typeof params == "number" && !isNaN(params) )  {
            return true;
        }else{
            return false;
        }
    }

    function set4out5in(num,length) {
        var numString = String(num);
        var nums = numString.split(".");
        var intNum = parseInt(nums[0]);
         // 如果不是小数，补充对应的0
        if (nums.length == 1) {
            return nums[0] +"."+"0".repeat(length);
        }
        else{
            // 如果是小数 但位数比要保留的位数少 也是要补0
            if (nums[1].length < length) {
                return nums[0] +"."+nums[1]+"0".repeat(length - nums[1].length);
            } else {
                //取小数部分
                var frontdecimal = parseInt(nums[1].substr(0,length));
                // 去除要保留小数的后一位
                var lastdecimal = parseInt(nums[1].substr(length,1));
                console.log(frontdecimal);
                console.log(lastdecimal);

                
                // 如果最后一位大于5就进位
                if (lastdecimal >= 5) {
                    if (isNaN(frontdecimal)) {//取整数
                        intNum = (intNum*(Math.abs(intNum)/intNum)+1)*(Math.abs(intNum)/intNum);
                    }else{
                    frontdecimal += 1;
                    }
                }
                //判断小数部位是否需要进位 类似于19.996 保留2位小数 就是20.00
                if (frontdecimal == Math.pow(10,length)) {
                    frontdecimal = "0".repeat(length);
                    intNum += 1;
                }
                //处理 0.015 0.009 保留的小数中有0出现的情况
                console.log(length);
                if(length != 0){
                    frontdecimal = "0".repeat(length - String(frontdecimal).length) + frontdecimal;
                    return intNum+"."+frontdecimal;
                }else{
                    return intNum;
                }
                
            }
        }

    }


    </script>
</body>
</html>